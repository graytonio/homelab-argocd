{% if traefik_ssl_enabled %}
- op: add
  path: /spec/template/spec/containers/0/args/-
  value: --certificatesresolvers.cloudflare.acme.dnschallenge=true
- op: add
  path: /spec/template/spec/containers/0/args/-
  value: --certificatesresolvers.cloudflare.acme.dnschallenge.provider=cloudflare
- op: add
  path: /spec/template/spec/containers/0/args/-
  value: --certificatesresolvers.cloudflare.acme.email={{ traefik_ssl.email }}
- op: add
  path: /spec/template/spec/containers/0/args/-
  value: --certificatesresolvers.cloudflare.acme.storage=/certs/acme.json
# - op: add
#   path: /spec/template/spec/containers/0/args/-
#   value: --entrypoints.web.http.redirections.entrypoint.to=websecure
# - op: add
#   path: /spec/template/spec/containers/0/args/-
#   value: --entrypoints.web.http.redirections.entrypoint.scheme=https
- op: add
  path: /spec/template/spec/containers/0/args/-
  value: --entrypoints.websecure.http.tls.certResolver=cloudflare
- op: add
  path: /spec/template/spec/containers/0/args/-
  value: --entrypoints.websecure.http.tls.domains[0].main={{ traefik_ssl.base_domain }}
- op: add
  path: /spec/template/spec/containers/0/args/-
  value: --entrypoints.websecure.http.tls.domains[0].sans=*.{{ traefik_ssl.base_domain }}
{% endif %}

{% if traefik_ssl_stage_enabled %}
- op: add
  path: /spec/template/spec/containers/0/args/-
  value: --certificatesresolvers.cloudflare.acme.caServer={{ traefik_ssl_stage }}
{% endif %}

{% if traefik_log_level %}
- op: add
  path: /spec/template/spec/containers/0/args/-
  value: --log.level={{ traefik_log_level }}
{% endif %}